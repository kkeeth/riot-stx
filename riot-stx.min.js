riotStx={cs:{},create(t,n){riotStx.installState(t),riot.install(function(t){riotStx.installRiotPlugin(t)})},installState(...t){stx=new Proxy({},{set:function(t,n,e){return"_"!=n[0]&&JSON.stringify(t[n])!==JSON.stringify(e)&&(t[n]=e,riotStx.cs[n]&&riotStx.cs[n].forEach(t=>{t.stx[n]=e,t.update()}),window.dispatchEvent(new CustomEvent("stx_"+n,{[n]:e,updatedState:n}))),!0}}),t.forEach(t=>{riotStx.deepExtend(stx,stx,t)})},installRiotPlugin(t){const{onBeforeMount:n,onMounted:e,onBeforeUpdate:o,onUpdated:i,onBeforeUnmount:s,onUnmounted:r}=t;t.stx=new Proxy(t.stx||{},{set:function(n,e,o){return"_"!=e[0]&&void 0!==t.stx[e]&&JSON.stringify(n[e])!==JSON.stringify(o)?(n[e]=o,stx[e]=o,window.dispatchEvent(new CustomEvent("stx_"+e,{[e]:o,updatedState:e}))):n[e]=o,!0}}),t.onBeforeMount=function(...e){for(let[n,e]of Object.entries(t.stx))"_"!=n[0]&&(riotStx.cs[n]||(riotStx.cs[n]=[]),riotStx.cs[n].push(t),void 0!==stx[n]&&(t.stx[n]=stx[n]));n&&n.apply(this,e)},t.onUnmounted=function(...n){if(riotStx.cs)for(var e in riotStx.cs)riotStx.cs[e].forEach((n,o)=>{n===t&&riotStx.cs[e].splice(o,1)});r&&r.apply(this,n)}},setOneState(t,n){stx[t]=n},setState(t){riotStx.deepExtend(stx,stx,t)},deepExtend(t){t=t||{};for(var n=1;n<arguments.length;n++){var e=arguments[n];if(e)for(var o in e)e.hasOwnProperty(o)&&("object"==typeof e[o]?e[o]instanceof Array==1?t[o]=e[o].slice(0):t[o]=riotStx.deepExtend(t[o],e[o]):t[o]=e[o])}return t}};
